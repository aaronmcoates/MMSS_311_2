---
title: "HW1"
author: "Aaron Coates"
date: "4/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
sick <- read.csv("/Users/aaroncoates/Downloads/sick_data.csv")

library(dplyr)
library(ggplot2)
library(glmnet)
library(broom)
library(aod)
```

```{r}
sick$result.d <- sapply(sick$result, function(x){
  if(x == "Positive"){
    1
  } else {
    0
  }})
```

```{r}
regOLS <- glm(result.d ~ temp + bp, data=sick) %>% broom::tidy()
for (i in 1:1000) {sick$predictionOLS[i] <- regOLS[1, 2] + regOLS[2, 2]*sick$temp[i] + regOLS[3,2]*sick$bp[i]}
```

```{r}
sum(with(sick, result.d==1 & predictionOLS>=.5))
sum(with(sick, result.d==1 & predictionOLS<=.5))
sum(with(sick, result.d==0 & predictionOLS>=.5))
sum(with(sick, result.d==0 & predictionOLS<=.5))
```

```{r}
intOLS <- (regOLS[1, 2] -.5)/(-regOLS[3, 2]) 
slopeyOLS <- regOLS[2, 2]/(-regOLS[3,2])
```

```{r}
plotOLS <- ggplot(data = sick, aes(x = temp, y = bp, col=result)) + geom_point() + geom_abline(intercept = intOLS[1, 1], slope = slopeyOLS[1, 1])
```

```{r, echo=FALSE}
plotOLS
```

```{r}
sick$result <- factor(sick$result)
logit <- glm(result ~ temp + bp, data = sick, family = "binomial") %>% broom::tidy()
for (i in 1:1000) {sick$predictionLOGIT[i] <- logit[1, 2] + logit[2, 2]*sick$temp[i] + logit[3,2]*sick$bp[i]}
```

```{r}
sum(with(sick, result.d==1 & predictionLOGIT>=.5))
sum(with(sick, result.d==1 & predictionLOGIT<=.5))
sum(with(sick, result.d==0 & predictionLOGIT>=.5))
sum(with(sick, result.d==0 & predictionLOGIT<=.5))
```

```{r}
intLOG <- (logit[1, 2] -.5)/(-logit[3, 2]) 
slopeyLOG <- logit[2, 2]/(-logit[3,2])
```

```{r}
plotLOG <- ggplot(data = sick, aes(x = temp, y = bp, col=result)) + geom_point() + geom_abline(intercept = intLOG[1, 1], slope = slopeyLOG[1, 1])
```

```{r, echo=FALSE}
plotLOG
```




#garbage
OLScorrect <- vector()
for (i in 1:1000){OLScorrect[i] <-  if(sick$result.d[i] == 1 & sick$predictionOLS[i] >= .5){
  1
} else {
  0
}}
sum(OLScorrect)
sum(result.d)
  
logitcorrect <- vector()
for (i in 1:1000){OLScorrect[i] <-  if(sick$result.d[i] == 1 & sick$predictionOLS[i] >= .5){
  1
} else {
  0
}}

ridge <- glmnet(x = as.matrix(sick[, 2:3]), y = sick$result.d, alpha=0, lambda=1) %>% broom::tidy()
for (i in 1:1000) {sick$predictionRIDGE[i] <- ridge[1, 3] + ridge[2, 3]*sick$temp[i] + ridge[3,3]*sick$bp[i]}

