---
title: "HW1 Num2"
author: "Aaron Coates"
date: "4/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
setwd("~/Documents/GitHub/MMSS_311_2")
wid <- read.csv("/Users/aaroncoates/Downloads/widget_data.csv")

library(dplyr)
library(ggplot2)
library(glmnet)
library(broom)
library(aod)

```{r}
grid=10^seq(2,-2,length=100)
ridge <- glmnet(x = as.matrix(wid[, -1]), y = wid$y, alpha=0, lambda=grid)
```

```{r, echo=FALSE}
plot(ridge, label = TRUE)
```

```{r}
ridge1 <- tidy(ridge)
ridge2 <- ridge1[ which(ridge1$term!='(Intercept)'), ]
```

```{r, echo=FALSE}
ggplot(data=ridge2, aes(x=lambda, y=estimate, colour=term)) + 
  geom_line() + coord_cartesian(xlim = c(0,100), ylim = c(-.5, .5))
```

```{r}
crossval <- cv.glmnet(x = as.matrix(wid[, -1]), y = wid$y, alpha=0, lambda=grid)
```

```{r, echo=FALSE}
plot(crossval)
```

```{r}
crossval$lambda.min
coef(crossval, s = "lambda.min")
```

```{r}
grid=10^seq(2,-2,length=100)
lasso <- glmnet(x = as.matrix(wid[, -1]), y = wid$y, alpha=1, lambda=grid)
```

```{r, echo=FALSE}
plot(lasso, label = TRUE)
```

```{r}
lasso1 <- tidy(lasso)
```

```{r, echo=FALSE}
ggplot(data=lasso1, aes(x=lambda, y=estimate, colour=term)) + 
  geom_line() + coord_cartesian(xlim = c(0,2), ylim = c(-1, 1))
```

```{r}
crossvallasso <- cv.glmnet(x = as.matrix(wid[, -1]), y = wid$y, alpha=1, lambda=grid)
```

```{r, echo=FALSE}
plot(crossvallasso)
```

```{r}
crossvallasso$lambda.min
coef(crossvallasso, s = "lambda.min")
```
